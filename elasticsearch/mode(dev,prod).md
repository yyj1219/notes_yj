Elasticsearch/OpenSearch에서 노드(Node)의 실행 모드는 개발 모드와 운영 모드, 2가지가 있습니다.

두 모드의 큰 차이점은 개발 모드에서는 올바르게 구성되지 않은 요소들(시스템, JVM 및 Elasticsearch 설정)에 대해 경고만 하는 반면, 운영 모드에서는 노드가 시작될 때 이러한 검사에 오류가 발생하면 노드 시작이 거부된다는 겁니다.

# 개발(development) 모드

- **안정성 설정**: 최소화합니다. 예를 들어, 메모리 잠금, 가상 메모리 크기 설정 등은 기본적으로 설정되지 않습니다.
- **보안 설정**: 비활성화된 경우가 많습니다. 인증이나 데이터 암호화 등이 필수적으로 설정되지 않습니다.
- **노드 디스커버리**: 단일 노드로 동작하거나, 개발 환경에서 간편하게 클러스터를 구성할 수 있도록 discovery 기능이 유연하게 동작할 수 있습니다.
- **성능 최적화**: 기본적으로 성능 최적화를 위한 특별한 설정이 없습니다.

# 운영(production) 모드

- **안정성 설정**: 메모리 잠금(`bootstrap.memory_lock: true`), 스왑비활성화, 파일 핸들 수 제한 등 시스템 자원을 최적화하는 설정이 필요합니다.
- **보안 설정**: 사용자 인증, 전송 계층 보안(TLS), 데이터 암호화 등 보안 관련 설정이 필수적입니다.
- **노드 디스커버리**: 클러스터의 안정성을 위해 노드 자동 discovery가 더 엄격하게 설정되며, 여러 노드가 있을 경우에는 초기 마스터 노드를 명시적으로 설정해야 합니다.
- **성능 최적화**: JVM 힙 메모리 크기, 가비지 컬렉션, 디스크 I/O 설정 등 성능 최적화가 필요합니다.
- **클러스터 구성**: 고가용성을 위해 3개 이상의 마스터 노드를 권장하며, 샤드 및 레플리카 설정되 신중하게 고려해야 합니다.

# 판단 기준

노드가 운영 모드인지 개발 모드인지는 자동으로 판단되는데, 주로 **노드의 네트워크 설정**과 **클러스터 구성**에 따라 판단됩니다.

## 운영 모드와 개발 모드를 구분하는 주요 기준

1. **Networ Host 설정**
  - **운영모드**: `network.host`가 `localhost`, `127.0.0.1` 혹은 `[::1]` 같은 로컬 IP주소가 아닌, 실제 네트워크 인터페이스에(예: `0.0.0.0` 또는 특정 IP)로 설정된 경우
  - **개발모드**: `network.host`가 `localhost`, `127.0.0.1` 혹은 `[::1]` 으로 설정된 경우
2. **Discovery 설정**
  - **운영모드**: 클러스터의 다른 노드를 발견하기 위한 설정(`discovery.seed_hosts`, `discovery.type`, `cluster.initial_master_nodes` 등)이 명시적으로 설정된 경우
  - **개발모드**: `discovery.type: single-node`가 설정된 경우. 단일 노드 클러스터로 동작하며, 다른 노드를 검색하거나 초기 마스터 노드를 설정하지 않음

# 부트스트랩 검사

운영모드로 판단되면, Elasticsearch/OpenSearch는 시작 시 **부트스트랩 검사**를 수행하여 시스템 설정이 운영 환경에 적합한지 확인합니다.

부트스트랩 검사 항목에는 다음이 포함됩니다.
- **메모리 잠금** (`bootstrap.memory_lock: true` 설정)
- **파일 핸들 수** (`max file descriptors`)
- **가상 메모리 영역 크기** (`vm.max_map_count`)
- **스왑 사용 여부**
- **디렉토리 권한** (데이터 및 로그 디렉토리에 대한 적절한 권한 설정)

부트스트랩 검사를 통과하지 못 하면, Elasticsearch/OpenSearch는 운영 모드에서 시작할 수 없고 오류를 발생시킵니다.

개발 모드에서는 이와 같은 검사가 비활성화되거나, 경고만 발생하고 계속 실행될 수 있습니다.
